let minnanohongo = 
[
    [
        {question: 'わたしたち', sound: 'Watashi-tachi', answer: 'chúng tôi/ chúng ta'},
        {question: 'わたし', sound: 'Watashi', answer: 'tôi'},
        {question: 'あなた', sound: 'Anata', answer: 'anh/chị, ông/bà, bạn (ngôi thứ II số ít)'},
        {question: 'あのひと(あのかた)', sound: 'Ano hito (ano kata)', answer: 'người kia'},
        {question: 'みなさん', sound: 'Minasan', answer: 'các anh chị, các ông bà, các bạn, quý vị'},
        {question: '~さん', sound: '~-San', answer: 'anh, chị, ông, bà'},
        {question: '~ちゃん', sound: '~-Chan', answer: '(hậu tố thêm vào sau tên của trẻ em thay cho「~さん」)'},
        {question: '~くん', sound: '~-Kun', answer: '(hậu tố thêm vào sau tên của em trai)'},
        {question: '~じん', sound: '~ Jin', answer: 'người (nước) ~ '},
        {question: 'せんせい', sound: 'Sensei', answer: 'thầy/cô '},
        {question: 'きょうし', sound: 'Kyōshi', answer: 'giáo viên'},
        {question: 'がくせい', sound: 'Gaku sei', answer: 'học sinh, sinh viên'},
        {question: 'かいしゃいん', sound: 'Kaisha in', answer: 'nhân viên công ty'},
        {question: 'しゃいん', sound: 'Sha in', answer: 'nhân viên Công ty ~ '},
        {question: 'ぎんこういん', sound: 'Gin kōin', answer: 'nhân viên ngân hàng'},
        {question: 'いしゃ', sound: 'Isha', answer: 'bác sĩ'},
        {question: 'けんきゅうしゃ', sound: 'Ken kyū sha', answer: 'nhà nghiên cứu'},
        {question: 'エンジニア', sound: 'Enjinia', answer: 'kỹ sư'},
        {question: 'だいがく', sound: 'Dai gaku', answer: 'đại học, trường đại học'},
        {question: 'びょういん', sound: 'Byō in', answer: 'bệnh viện'},
        {question: 'でんき', sound: 'Den ki', answer: 'điện, đèn điện'},
        {question: 'だれ ( どなた)', sound: 'Dare (donata)', answer: 'ai - vị nào'},
        {question: 'あの人(あの方)', sound: 'Ano hito (ano hō)', answer: 'người đó'},
        {question: '-さい', sound: '– Sai', answer: '– tuổi'},
        {question: 'なんさい (おいくつ)', sound: 'Nan sai (o ikutsu)', answer: 'mấy tuổi, bao nhiêu tuổi'},
        {question: 'はい', sound: 'Hai', answer: 'vâng, dạ'},
        {question: 'いいえ', sound: 'Īe', answer: 'không'},
        {question: 'しつれいですが', sound: 'Shitsure idesuga', answer: 'xin lỗi,…'},
        {question: 'おなまえは?', sound: 'O na ma e wa?', answer: 'Tên anh/chị là gì?'},
        {question: 'はじめまして。', sound: 'Hajimemashite.', answer: 'Rất hân hạnh được gặp anh/chị'},
        {question: 'どうぞよろしくおねがいします。', sound: 'Dōzo yoroshiku onegai shimasu.', answer: 'Rất mong được sự giúp đỡ của anh/chi.'},
        {question: 'こちらは～さんです。', sound: 'Kore wa watashidesu', answer: 'Đây là anh/chị/ông/bà .'},
        {question: '~からきました。', sound: '~ Kara kimashita.', answer: '(Tôi) đến từ …,'},
        {question: 'アメリカ', sound: 'Amerika', answer: 'Mỹ'},
        {question: 'イギリス', sound: 'Igirisu', answer: 'Anh'},
        {question: 'インド', sound: 'Indo', answer: 'Ấn Độ.'},
        {question: 'インドネシア', sound: 'Indoneshia', answer: 'Indonesia'},
        {question: 'かんこく', sound: 'Kankoku', answer: 'Hàn Quốc'},
        {question: 'タイ', sound: 'Tai', answer: 'Thái Lan'},
        {question: 'ちゅうごく', sound: 'Chūgoku', answer: 'Trung Quốc'},
        {question: 'ドイツ', sound: 'Doitsu', answer: 'Đức'},
        {question: 'にほん', sound: 'Nihon', answer: 'Nhật Bản'},
        {question: 'フランス', sound: 'Furansu', answer: 'Pháp'},
        {question: 'ブラジル', sound: 'Burajiru', answer: 'Braxin'}
    ],
    [
        {question: 'これ', sound: 'Kore', answer: 'cái này, đây (vật ở gần người nói)'},
        {question: 'それ', sound: 'Sore', answer: 'cái đó, đó (vật ở gần người nghe)'},
        {question: 'あれ', sound: 'Are', answer: 'cái kia, kia (vật ở xa cả người nói và người nghe)'},
        {question: 'この~', sound: 'Kono ~', answer: '~ này'},
        {question: 'その〜', sound: 'Sono 〜', answer: '~ đó'},
        {question: 'あの~', sound: 'Ano ~', answer: '~ kia'},
        {question: 'ほん', sound: 'Hon', answer: 'sách'},
        {question: 'でしょ', sound: 'Desho', answer: 'từ điển'},
        {question: 'ざっし', sound: 'Zasshi', answer: 'tạp chí'},
        {question: 'しんぶん', sound: 'Shinbun', answer: 'báo'},
        {question: 'ノート', sound: 'Nōto', answer: 'vở'},
        {question: 'てちょう', sound: 'Te chō', answer: 'sổ tay'},
        {question: 'めいし', sound: 'Meishi', answer: 'danh thiếp'},
        {question: 'カード', sound: 'Kādo', answer: 'thẻ, các, cạc'},
        {question: 'テレホンカード', sound: 'Terehonkādo', answer: 'thẻ điện thoại'},
        {question: 'えんぴつ', sound: 'Enpitsu', answer: 'bút chì'},
        {question: 'ボールペン', sound: 'Bōrupen', answer: 'bút bi'},
        {question: 'シャープペンシル', sound: 'Shāpupenshiru', answer: 'bút chì kim, bút chì bấm'},
        {question: 'かぎ', sound: 'Kagi', answer: 'chìa khóa'},
        {question: 'とけい', sound: 'Tokei', answer: 'đồng hồ'},
        {question: 'かさ', sound: 'Kasa', answer: 'ô, dù'},
        {question: 'かばん', sound: 'Kaban', answer: 'cặp sách, túi sách'},
        {question: '[カセット]テーブ', sound: '[Kasetto] tēpu', answer: 'băng (cát-xét)'},
        {question: 'テープレコーダー', sound: 'Tēpurekōdā', answer: 'máy ghi âm'},
        {question: 'テレビ', sound: 'Terebi', answer: 'tivi'},
        {question: 'ラジオ', sound: 'Rajio', answer: 'radio'},
        {question: 'カメラ', sound: 'Kamera', answer: 'máy ảnh'},
        {question: 'コンピューター', sound: 'Konpyūtā', answer: 'máy vi tính'},
        {question: 'じどうしゃ', sound: 'Jidōsha', answer: 'ô tô'}
    ],
    [
        {question: 'ここ', sound: 'Koko', answer: 'chỗ này, đây'},
        {question: 'そこ', sound: 'Soko', answer: 'chỗ đó, đó'},
        {question: 'あそこ', sound: 'Asoko', answer: 'chỗ kia, kia'},
        {question: 'どこ', sound: 'Doko', answer: 'chỗ nào, đâu'},
        {question: 'こちら', sound: 'Kochira', answer: 'phía này, đằng này, chỗ này, đây (cách nói lịch sự của [ここ])'},
        {question: 'そちら', sound: 'Sochira', answer: 'phía đô, đằng đó, chỗ đó, đó (cách nói lịch sự của「そこ」)'},
        {question: 'あちら', sound: 'Achira', answer: 'phía kia, đằng kia, chỗ kia, kia (cách nói lịch sự của 「あそこ」)'},
        {question: 'どちら', sound: 'Dochira', answer: 'phía nào, đằng nào, chỗ nào, đâu (cách nói lịch sự của 「どこ｣)'},
        {question: 'きょうしつ', sound: 'Kyōshitsu', answer: 'lớp học, phòng học'},
        {question: 'しょくどう', sound: 'Shoku dō', answer: 'nhà ăn'},
        {question: 'じむしょ', sound: 'Ji mushi ~yo', answer: 'văn phòng'},
        {question: 'かいぎしつ', sound: 'Kai gishitsu', answer: 'phòng họp'},
        {question: 'うけつけ', sound: 'Uketsuke', answer: 'bộ phận tiếp tân, phòng thường trực'},
        {question: 'ロビー', sound: 'Robī', answer: 'hành lang, đại sảnh'},
        {question: 'へや', sound: 'Heya', answer: 'căn phòng'},
        {question: 'トイレ (おてあらい)', sound: 'Toire (o tearai)', answer: 'nhà vệ sinh, phòng vệ sinh, toa lét'},
        {question: 'かいだん', sound: 'Kaidan', answer: 'cầu thang'},
        {question: 'エレベーター', sound: 'Erebētā', answer: 'thang máy'},
        {question: 'エスカレーター', sound: 'Esukarētā', answer: 'thang cuốn'},
        {question: '[お] くに', sound: '[O] kuni', answer: 'đất nước (của anh/chị)'},
        {question: 'かいしゃ', sound: 'Kaisha', answer: 'công ty'},
        {question: 'うち', sound: 'Uchi', answer: 'nhà'},
        {question: 'でんわ', sound: 'Denwa', answer: 'máy điện thoại, điện thoại'},
        {question: 'くつ', sound: 'Kutsu', answer: 'giầy'},
        {question: 'ネクタイ', sound: 'Nekutai', answer: 'cà-vạt'},
        {question: 'ワイン', sound: 'Wain', answer: 'rượu vang'},
        {question: 'たばこ', sound: 'Tabako', answer: 'thuốc lá'},
        {question: 'うりば', sound: 'Uriba', answer: 'quầy bán (trong một bách hóa)'},
        {question: 'ちか', sound: 'Chika', answer: 'tầng hầm, dưới mặt đất'},
        {question: 'ーかい(がい)', sound: '– Kai (gai)', answer: 'tầng thứ –'},
        {question: 'なんがい', sound: 'Nan ga i', answer: 'tầng mấy'},
        {question: 'えん', sound: 'En', answer: '– yên'},
        {question: 'いくら', sound: 'Ikura', answer: 'bao nhiêu tiền'},
        {question: 'ひゃく', sound: 'Hyaku', answer: 'trăm'},
        {question: 'せん', sound: 'Sen', answer: 'nghìn'},
        {question: 'まん', sound: 'Man', answer: 'mười nghìn, vạn'},
        {question: 'すみません。', sound: 'Sumimasen.', answer: 'Xin lỗi.(cách nói lịch sự của [です)'},
        {question: '[を] 見せてください。', sound: '[O ] misetekudasai.', answer: 'cho tôi xem [~]'},
        {question: 'じゃ', sound: 'Ja', answer: 'thế thì, vậy thì'},
        {question: '[~を〕ください。', sound: '[~ O〕 kudasai.', answer: 'cho tôi [~]'},
        {question: '新大阪', sound: 'Shin’ōsaka', answer: 'tên một nhà ga ở Osaka'},
        {question: 'イタリア', sound: 'Itaria', answer: 'Ý'},
        {question: 'スイス', sound: 'Suisu', answer: 'Thụy Sĩ'}
    ],
    [
        {question: 'おきます', sound: 'Okimasu', answer: 'Dậy, thức dậy'},
        {question: 'ねます', sound: 'Nemasu', answer: 'ngủ, đi ngủ'},
        {question: 'はたらきます', sound: 'Hatarakimasu', answer: 'làm việc'},
        {question: 'やすみます', sound: 'Yasumimasu', answer: 'nghỉ, nghỉ ngơi'},
        {question: 'べんきょうします', sound: 'Ben kyō shimasu', answer: 'Học'},
        {question: 'おわります', sound: 'Owarimasu', answer: 'Sắp kết thúc, xong'},
        {question: 'デパート', sound: 'Depāto', answer: 'bách hóa'},
        {question: 'ぎんこう', sound: 'Gin kō', answer: 'Ngân hàng'},
        {question: 'ゆうびんきょく', sound: 'Yūbinkyoku', answer: 'Bưu điện'},
        {question: 'としょかん', sound: 'To sho kan', answer: 'Thư viện'},
        {question: 'びじゅつかん', sound: 'Bijutsukan', answer: 'Bảo tàng mỹ thuật'},
        {question: 'いま', sound: 'Ima', answer: 'Bây giờ'},
        {question: 'ーじ', sound: '– Ji', answer: '– giờ'},
        {question: 'ふんぷん)', sound: '– Fun pun', answer: '– phút'},
        {question: 'はん', sound: 'Han', answer: 'Rưỡi, nửa'},
        {question: 'なんじ', sound: 'Nanji', answer: 'Mấy giờ'},
        {question: 'なんぶん', sound: 'Nan bun', answer: 'Mấy phút'},
        {question: 'ごぜん', sound: 'Go zen', answer: 'trước mười hai giờ trưa, sáng'},
        {question: 'ごご', sound: 'Go go', answer: 'Sau mười hai giờ trưa, chiều'},
        {question: '休み', sound: 'Yasum', answer: 'Buổi sáng, sáng'},
        {question: 'ひる', sound: 'Hiru', answer: 'Buổi trưa, trưa'},
        {question: 'ばん(よる)', sound: 'Ban (yoru)', answer: 'buổi tối, tối'},
        {question: 'おととい', sound: 'Ototoi', answer: 'Hôm kia'},
        {question: 'きのう', sound: 'Kinō', answer: 'Hôm qua'},
        {question: 'きょう', sound: 'Kyō', answer: 'Hôm nay'},
        {question: 'あした', sound: 'Ashita', answer: 'Ngày mai'},
        {question: 'あさって', sound: 'Asatte', answer: 'Ngày kia'},
        {question: 'けさ', sound: 'Kesa', answer: 'Sáng nay'},
        {question: 'こんばん', sound: 'Kon ban', answer: 'Tối nay'},
        {question: 'やすみ', sound: 'Yasumi', answer: 'Nghỉ, nghỉ phép, Ngày nghỉ'},
        {question: 'ひるやすみ', sound: 'Hiru Yasumi', answer: 'Nghỉ trưa'},
        {question: 'まいあざ', sound: 'Mai aza', answer: 'hàng sáng, mỗi sáng'},
        {question: 'まいばん', sound: 'Ma iban', answer: 'hàng tối, mỗi tối.'},
        {question: 'まいにち', sound: 'Mai ni chi', answer: 'hàng ngày, mỗi ngày'},
        {question: 'げつようび', sound: 'Getsu yō bi', answer: 'Thứ hai'},
        {question: 'かようび、', sound: 'Kayō bi', answer: 'Thứ ba'},
        {question: 'すいようび', sound: 'Sui yō bi', answer: 'Thứ tư'},
        {question: 'もくようび', sound: 'Mo ku yō bi', answer: 'Thứ năm'},
        {question: 'きんようび', sound: 'Kin-yō bi', answer: 'Thứ sáu'},
        {question: 'どようび', sound: 'Do yō bi', answer: 'Thứ bảy'},
        {question: 'にちようび', sound: 'Ni chi yō bi', answer: 'Chủ nhật'},
        {question: 'なんようび', sound: 'Nan-yō bi', answer: 'Thứ mấy'},
        {question: 'ばんごう', sound: 'Ban gou', answer: 'số (số điện thoại, số phòng)'},
        {question: 'なんばん', sound: 'Nan ban', answer: 'số bao nhiêu, số mấy'},
        {question: '~から', sound: '~ Kara', answer: '~ từ'},
        {question: '~まで', sound: '~ Made', answer: '~ đến'},
        {question: '~と~', sound: '~ To ~', answer: '~ và (dùng để nối hai danh từ)'},
        {question: 'そちら', sound: 'Sochira', answer: 'ông bà, phía ông/phía bà'},
        {question: 'たいへんですね。大変ですね。', sound: 'Taihendesu ne. Taihendesu ne.', answer: 'Anh/Chị vất vả quá.'},
        {question: 'えーと。', sound: 'E ̄ to.', answer: 'ừ, à (từ đệm trong hội thoại khi đang nghĩ điều muốn nối)'},
        {question: '104', sound: '', answer: 'số điện thoại của dịch vụ hướng dân số điện thoại'},
        {question: 'お願いします。', sound: 'Onegaishimasu.', answer: 'Nhờ anh/chị. Phiền anh/chị.'},
        {question: 'びじゅつせん', sound: 'Bijutsu sen', answer: 'Tôi hiểu rồi ạ. Vâng, được rồi ạ.'},
        {question: 'お問い合わせの番号', sound: 'O toiawase no bangō', answer: 'số điện thoại mà ông/bà muốn hỏi'},
        {question: '[どうも] ありがとうございました。', sound: '[Dōmo] arigatōgozaimashita.', answer: 'Xin cảm ơm ông/bà'},
        {question: 'ニューヨーク', sound: 'Nyūyōku', answer: 'New York'},
        {question: '北京', sound: 'Pekin', answer: 'Bắc Kinh'},
        {question: 'ロンドン', sound: 'Rondon', answer: 'Luân Đôn'},
        {question: 'バンコク', sound: 'Bankoku', answer: 'Băng Cốc'}
        ],
    [
        {question: 'いきます', sound: 'Ikimasu', answer: 'đi'},
        {question: 'きます', sound: 'Kimasu', answer: 'đến'},
        {question: 'かえります', sound: 'Kaerimasu', answer: 'về'},
        {question: 'がっこう', sound: 'Gakkō', answer: 'trường học'},
        {question: 'スーパー', sound: 'Sūpā', answer: 'siêu thị'},
        {question: 'えき', sound: 'Eki', answer: 'ga, nhà ga'},
        {question: 'ひこうき', sound: 'Hikouki', answer: 'máy bay'},
        {question: 'ふね', sound: 'Fu ne', answer: 'thuyền, tàu thủy'},
        {question: 'でんしゃ', sound: 'Den sha', answer: 'tàu điện'},
        {question: 'ちかてつ', sound: 'Chika Tetsu', answer: 'tàu điện ngầm'},
        {question: 'しんかんせん', sound: 'Shinkan sen', answer: 'tàu Shinkansen (tàu điện siêu tốc của Nhật)'},
        {question: 'バス', sound: 'Basu', answer: 'xe buýt'},
        {question: 'タクシー', sound: 'Takushī', answer: 'tắc-xi'},
        {question: 'じてんしゃ', sound: 'Jiten sha', answer: 'xe đạp'},
        {question: 'あるいて', sound: 'Aruite', answer: 'đi bộ'},
        {question: 'ひと', sound: 'Hito', answer: 'người'},
        {question: 'ともだち', sound: 'Tomodachi', answer: 'bạn, ban bè'},
        {question: 'かれ', sound: 'Kare', answer: 'anh ấy, bạn trai'},
        {question: 'かのじょ', sound: 'Kanoji ~yo', answer: 'chị ấy, bạn gái'},
        {question: 'かぞく', sound: 'Ka zo ku', answer: 'gia đình'},
        {question: 'ひとりで', sound: 'Hitori de', answer: 'một mình'},
        {question: 'せんしゅう', sound: 'Senshū', answer: 'tuần trước'},
        {question: 'こんしゅう', sound: 'Kon shū', answer: 'tuần này'},
        {question: 'らいしゅう', sound: 'Rai shū', answer: 'tuần sau'},
        {question: 'せんげつ', sound: 'Sengetsu', answer: 'tháng trước'},
        {question: 'こんげつ', sound: 'Kon-getsu', answer: 'tháng này'},
        {question: 'らいげつ', sound: 'Rai-getsu', answer: 'tháng sau'},
        {question: 'きょねん', sound: 'Ki ~yonen', answer: 'năm ngoái'},
        {question: 'ことし', sound: 'Kotoshi', answer: 'năm nay'},
        {question: 'らいねん', sound: 'Rai nen', answer: 'sang năm'},
        {question: 'ーがつ', sound: 'Gatsu', answer: 'tháng –'},
        {question: 'なんがつ', sound: 'Nan gatsu', answer: 'tháng mấy'},
        {question: 'ついたち', sound: 'Tsuitachi', answer: 'ngày mồng 1'},
        {question: 'ふつか', sound: 'Futsu ka', answer: 'ngày mồng 2, 2 ngày'},
        {question: 'みっか', sound: 'Mikka', answer: 'ngày mồng 3, 3 ngày'},
        {question: 'よっか', sound: 'Yokka', answer: 'ngày mồng 4, 4 ngày'},
        {question: 'いつか', sound: 'Itsuka', answer: 'ngày mồng 5, 5 ngày'},
        {question: 'むいか', sound: 'Mui ka', answer: 'ngày mồng 6, 6 ngày'},
        {question: 'なのか', sound: 'Na no ka', answer: 'ngày mồng 7, 7 ngày'},
        {question: 'ようか', sound: 'Yō ka', answer: 'ngày mồng 8, 8 ngày'},
        {question: 'ここのか', sound: 'Koko no ka', answer: 'ngày mồng 9, 9 ngày'},
        {question: 'とおか', sound: 'To o ka', answer: 'ngày mồng 10, 10 ngày'},
        {question: 'じゅうよっか', sound: 'Jū yokka', answer: 'ngày 14, 14 ngày'},
        {question: 'はつか', sound: 'Hatsu ka', answer: 'ngày 20, 20 ngày'},
        {question: 'にじゅうよっか', sound: 'Ni jū yokka', answer: 'ngày 24, 24 ngày'},
        {question: '– にち', sound: '– Ni chi', answer: 'ngày … , – ngày'},
        {question: 'なんにち', sound: 'Nan ni chi', answer: 'ngày mấy, ngày bao nhiêu, mấy ngày, bao nhiêu ngày'},
        {question: 'いつ', sound: 'Itsu', answer: 'bao giờ, khi nào'},
        {question: 'たんじょうび', sound: 'Tanjō bi', answer: 'sinh nhật'},
        {question: 'ふつう', sound: 'Futsū', answer: 'tàu thường (dừng cả ở các ga lẻ)'},
        {question: 'きゅうこう', sound: 'Kyūkō', answer: 'tàu tốc hành'},
        {question: 'とっきゅう', sound: 'Tokkyū', answer: 'tàu tốc hành đặc biệt.'},
        {question: 'つぎの', sound: 'Tsugi no', answer: 'tiếp theo'},
        {question: 'どういたしまして。', sound: 'Dōitashimashite.', answer: 'Không có gì.'},
        {question: '一番線', sound: 'Ichiban-sen', answer: 'sân ga số –'},
        {question: '香線', sound: 'Ka-sen', answer: 'tên một khu phố ở Kyushu'},
        {question: '伏見', sound: 'Fushimi', answer: 'tên một khu phố ở Kyoto'},
        {question: '甲子園', sound: 'Kōshien', answer: 'tên một khu phố ở gần Osaka'},
        {question: '大阪城', sound: 'Ōsakajō', answer: 'Lâu đài Osaka, một lâu đài nổi tiếng ở Osaka'}
    ]
]
let selectPost = document.getElementById('post-select');
let postCurrent = 0;
let questionsSets = [];
// Add danh sách bài
var listpost = "";
for(let i = 0; i < minnanohongo.length; i++) {
    listpost += `<option value='${i}'>Bài ${i+1}</option>`;
}
selectPost.innerHTML = listpost;
// Danh sách câu hỏi và đáp án mẫu
function chunkArray(array, chunkSize) {
    const chunks = [];
    for (let i = 0; i < array.length; i += chunkSize) {
        chunks.push(array.slice(i, i + chunkSize));
    }
    return chunks;
}

let currentQuestionSet = 0;
let questions = [];
let answers = [];
let score = 0;
let selectedQuestion = null;
let selectedAnswer = null;
let matches = [];

// nhấn chọn
selectPost.addEventListener('change', function() {
    if (this.value) {
        postCurrent =  this.value;
        setListQuestion(this.value);
        initGame();
    } else {
        postCurrent = 1;
    }
});

function setListQuestion(postCurrent) {
    questionsSets = chunkArray(minnanohongo[postCurrent], 5);
}

function initGame() {
    if(postCurrent == 0) {
        setListQuestion(0);
    }
    // Lấy câu hỏi và đáp án từ bộ dữ liệu hiện tại
    const currentSet = questionsSets[currentQuestionSet];
    
    // Tạo mảng câu hỏi và đáp án
    questions = currentSet.map((item, index) => ({
        id: 'q' + index,
        text: item.question,
        correctAnswerId: 'a' + index
    }));
    
    answers = currentSet.map((item, index) => ({
        id: 'a' + index,
        text: item.answer
    }));
    
    // Xáo trộn câu hỏi và đáp án
    shuffleArray(questions);
    shuffleArray(answers);
    
    // Cập nhật giao diện
    renderItems();
    
    // Reset trạng thái
    score = 0;
    document.getElementById('scoreValue').textContent = score;
    selectedQuestion = null;
    selectedAnswer = null;
    matches = [];
    document.getElementById('message').textContent = '';
    
    // Xóa tất cả các đường nối
    const lines = document.querySelectorAll('.line');
    lines.forEach(line => line.remove());
}

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

function renderItems() {
    matches = [];
    const questionsContainer = document.getElementById('questionsContainer');
    const answersContainer = document.getElementById('answersContainer');
    
    // Xóa nội dung hiện tại
    questionsContainer.innerHTML = '';
    answersContainer.innerHTML = '';
    
    // Render câu hỏi
    questions.forEach(question => {
        const questionElement = document.createElement('div');
        questionElement.className = 'item question';
        questionElement.id = question.id;
        questionElement.textContent = question.text;
        
        // Nếu câu hỏi đã được nối, thêm class matched
        if (matches.some(match => match.questionId === question.id)) {
            questionElement.classList.add('matched');
        } else {
            questionElement.addEventListener('click', () => selectQuestion(question.id));
        }
        
        questionsContainer.appendChild(questionElement);
    });
    
    // Render đáp án
    answers.forEach(answer => {
        const answerElement = document.createElement('div');
        answerElement.className = 'item answer';
        answerElement.id = answer.id;
        answerElement.textContent = answer.text;
        
        // Nếu đáp án đã được nối, thêm class matched
        if (matches.some(match => match.answerId === answer.id)) {
            answerElement.classList.add('matched');
        } else {
            answerElement.addEventListener('click', () => selectAnswer(answer.id));
        }
        
        answersContainer.appendChild(answerElement);
    });
}

function selectQuestion(id) {
    // Bỏ chọn câu hỏi hiện tại (nếu có)
    if (selectedQuestion) {
        document.getElementById(selectedQuestion).classList.remove('selected', 'matchedfalse');
    }
    
    // Nếu chọn lại cùng một câu hỏi, hủy chọn
    if (selectedQuestion === id) {
        selectedQuestion = null;
        return;
    }
    
    // Chọn câu hỏi mới
    selectedQuestion = id;
    document.getElementById(selectedQuestion).classList.add('selected');
    document.getElementById(selectedQuestion).classList.remove('matchedfalse');
    const text = document.getElementById(selectedQuestion).innerText;  
    tts.speak(text);
    
    // Kiểm tra nếu cả câu hỏi và đáp án đều được chọn
    checkMatch();
}

function selectAnswer(id) {
    // Bỏ chọn đáp án hiện tại (nếu có)
    if (selectedAnswer) {
        document.getElementById(selectedAnswer).classList.remove('selected', 'matchedfalse');
    }
    
    // Nếu chọn lại cùng một đáp án, hủy chọn
    if (selectedAnswer === id) {
        selectedAnswer = null;
        return;
    }
    
    // Chọn đáp án mới
    selectedAnswer = id;
    document.getElementById(selectedAnswer).classList.add('selected');
    document.getElementById(selectedAnswer).classList.remove('matchedfalse');
    
    // Kiểm tra nếu cả câu hỏi và đáp án đều được chọn
    checkMatch();
}

function checkMatch() {
    if (!selectedQuestion || !selectedAnswer) return;
    
    // Tìm câu hỏi đã chọn
    const question = questions.find(q => q.id === selectedQuestion);
    
    // Kiểm tra xem đáp án có đúng không
    if (question.correctAnswerId === selectedAnswer) {
        // Đáp án đúng
        const questionElement = document.getElementById(selectedQuestion);
        const answerElement = document.getElementById(selectedAnswer);
        
        // Thêm class matched
        questionElement.classList.add('matched');
        questionElement.classList.remove('selected');
        answerElement.classList.add('matched');
        answerElement.classList.remove('selected');
        
        // Xóa event listener
        questionElement.replaceWith(questionElement.cloneNode(true));
        answerElement.replaceWith(answerElement.cloneNode(true));
        
        // Cập nhật matches
        matches.push({ questionId: selectedQuestion, answerId: selectedAnswer });
        
        // Tăng điểm
        score++;
        document.getElementById('scoreValue').textContent = score;
        
        // Hiển thị thông báo
        document.getElementById('message').textContent = 'Đúng!';
        setTimeout(() => {
            document.getElementById('message').textContent = '';
        }, 1500);
        
        // Kiểm tra nếu tất cả câu hỏi đã được nối
        if (matches.length === questions.length) {
            document.getElementById('message').textContent = 'Chúc mừng! Bạn đã hoàn thành trò chơi!';
        }
    } else {
        // Đáp án sai
        document.getElementById('message').textContent = 'Sai! Hãy thử lại.';
        const questionElement = document.getElementById(selectedQuestion);
        const answerElement = document.getElementById(selectedAnswer);
        
        // Thêm class matched
        questionElement.classList.add('matchedfalse');
        questionElement.classList.remove('selected');
        answerElement.classList.add('matchedfalse');
        answerElement.classList.remove('selected');
        setTimeout(() => {
            document.getElementById('message').textContent = '';
        }, 1500);
    }
    
    // Reset lựa chọn
    selectedQuestion = null;
    selectedAnswer = null;
}
// Khởi tạo trò chơi
initGame();

// Sự kiện nút bấm
document.getElementById('reset').addEventListener('click', initGame);
document.getElementById('newQuestions').addEventListener('click', () => {
    currentQuestionSet = (currentQuestionSet + 1) % questionsSets.length;
    initGame();
});